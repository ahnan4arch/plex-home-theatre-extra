find_all_sources(. bus_SRCS)
if(TARGET_COMMON_DARWIN)
  find_all_sources(osx bus_os_SRCS)
elseif(TARGET_WIN32)
  find_all_sources(win32 bus_os_SRCS)
else(TARGET_COMMON_DARWIN)
  if(HAVE_LIBUSB)
    list(APPEND bus_os_SRCS linux/PeripheralBusUSBLibUSB.cpp)
    list(APPEND bus_os_SRCS linux/PeripheralBusUSBLibUSB.h)
  endif()
  if(HAVE_LIBUDEV)
    list(APPEND bus_os_SRCS linux/PeripheralBusUSBLibUdev.cpp)
    list(APPEND bus_os_SRCS linux/PeripheralBusUSBLibUdev.h)
  endif()
endif()

if(HAVE_LIBCEC OR TARGET_WIN32)
  list(APPEND bus_SRCS virtual/PeripheralBusCEC.cpp)
endif(HAVE_LIBCEC OR TARGET_WIN32)

add_sources(${bus_SRCS} ${bus_os_SRCS})
